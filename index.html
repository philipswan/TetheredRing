<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <link rel="icon" type="image/svg+xml" href="favicon.svg" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>The Tethered Ring</title>
    <link href="tailwind.css" rel="stylesheet" />
    <!-- <script src="https://cdn.jsdelivr.net/gh/openlayers/openlayers.github.io@master/en/v6.4.3/build/ol.js"></script>  -->
    <style>
      body {
        margin: 0;
      }
    </style>
  </head>
  <body>
      <!-- <input id="scrubber" type="range" value="0" style="width: 300px"> -->
      <div class="flex h-screen bg-black">
      <div id="simContainer" class="w-full">
        <canvas></canvas>
        <script id="vertexShader" type="x-shader/x-vertex">
          varying vec2 vertexUV;
          varying vec3 vertexNormal;

          void main() {
              vertexUV = uv;
              vertexNormal = normalize(normalMatrix * normal);
              gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
          }
        </script>
        <script id="fragmentShader" type="x-shader/x-fragment">
          uniform sampler2D planetTexture;
          varying vec2 vertexUV;
          varying vec3 vertexNormal;

          void main() {
              float intensity = 1.05 - dot(vertexNormal, vec3(0.0, 0.0, 1.0 ));
              vec3 atmosphere = vec3(0.3, 0.6, 1.0) * pow(intensity, 1.5);
              gl_FragColor = vec4(atmosphere + texture2D(planetTexture, vertexUV).xyz, 1.0);
          }          
        </script>
        <script id="fragmentShaderInv" type="x-shader/x-fragment">
          uniform sampler2D planetTexture;
          varying vec2 vertexUV;
          varying vec3 vertexNormal;

          void main() {
              float intensity = 1.05 - dot(vertexNormal, vec3(0.0, 0.0, 1.0 ));
              vec3 atmosphere = vec3(0.3, 0.6, 1.0) * pow(intensity, 1.5);
              gl_FragColor = vec4(1, 1, 1, 1) - vec4(atmosphere + texture2D(planetTexture, vertexUV).xyz, 1.0);
          }          
        </script>
        <script id="atmosphereVertexShader" type="x-shader/x-vertex">
          varying vec3 vertexNormal;

          void main() {
              vertexNormal = normalize(normalMatrix * normal);
              gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.05 );
          }          
        </script>
        <script id="atmosphereFragmentShader" type="x-shader/x-fragment">
          varying vec3 vertexNormal;
          void main() {
              float intensity = pow(0.7 - dot(vertexNormal, vec3(0.0, 0.0, 1.0)), 4.0);
              gl_FragColor = vec4(0.3, 0.6, 1.0, 1.0) * intensity;
          }          
        </script>
        <script id="tetherVertexShader" type="x-shader/x-vertex">
          attribute vec3 center;
          varying vec3 vCenter;
          void main() {
            vCenter = center;
            gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
          }
        </script>
        <script id="tetherFragmentShader" type="x-shader/x-fragment">
          uniform float thickness;
          varying vec3 vCenter;
          void main() {
            vec3 afwidth = fwidth( vCenter.xyz );
            vec3 edge3 = smoothstep( ( thickness - 1.0 ) * afwidth, thickness * afwidth, vCenter.xyz );
            float edge = 1.0 - min( min( edge3.x, edge3.y ), edge3.z );
            gl_FragColor.rgb = gl_FrontFacing ? vec3( 0.9, 0.9, 1.0 ) : vec3( 0.4, 0.4, 0.5 );
            gl_FragColor.a = edge;
          }
        </script>
        <script type="module" src="./main.js"></script>
        <button id="createkml">Download kml file</button>
        <a download="info.txt" id="downloadlink" style="display: none">Download</a>
        <button id="createSpecs">Download specs file</button>
        <a download="info.txt" id="downloadlink" style="display: none">Download</a>
         <!-- Invisible Stuff -->
        <div id="container">
          <div id="map" style="position: fixed; visibility:hidden; width: 1000px; height:500px;"></div>
          </div>
          <div id="container-lod1">
          <div id="map-lod1" style="position: fixed; visibility:hidden; width: 500px; height:500px;"></div>
          </div>
      </div>
    </div>
  </body>
</html>


